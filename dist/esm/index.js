import e,{useRef as t,useState as r,useEffect as l}from"react";import n from"styled-components";const i=n=>{const i=t(null),[o,c]=r(0);return window.addEventListener("scroll",(e=>{})),l((()=>{i&&i.current&&c(i.current.scrollTop)}),[]),e.createElement("div",{style:{height:n.small?"100px":"100vh",display:"flex",flexDirection:"column",justifyContent:"center"}},e.createElement("p",null,n.title),e.createElement("p",{ref:i,style:{textAlign:"center",fontSize:n.small?"1em":"5em",margin:"auto"}},n.children?n.children:"Hello World, react-scroll-presentation"))},o=n.div`
    contain: paint;
`,c=n.div`
    overflow: scroll;
`,s=e.createContext({scroll:0,scrollHeight:0,height:0}),h=n=>{const[i,h]=r(0),d=t(new Array),a=t(),u=t(),[g,p]=r(-1),[m,f]=r(!1),[y,v]=r([]),[w,b]=r([]);return l((()=>{if(n.fullScreen){const e=e=>{p(window.scrollY),f(window.scrollY!==g)};return document.addEventListener("scroll",e),()=>document.removeEventListener("scroll",e)}if(a.current){const e=e=>{p(u.current.scrollTop),f(u.current.scrollY!==g)};return u.current.addEventListener("scroll",e),()=>u.current.addEventListener("scroll",e)}}),[g]),l((()=>{if(Array.isArray(n.children))v(n.children.map(((t,r)=>e.cloneElement(t,{startScroll:w[r],endScroll:w[r+1],ref:d.current[r]}))));else if(n.children){let t=[e.cloneElement(n.children,{startScroll:0,ref:d.current[0]})];v(t)}}),[n,w]),l((()=>{}),[d]),l((()=>{var e;let t=[0];if(null===(e=a.current)||void 0===e?void 0:e.children.length){let e=0;for(let r=0;r<a.current.children.length;r++){let l=a.current.children.item(r).scrollHeight;e+=l,r<a.current.children.length-1&&(t[r+1]=0===r?l:t[r]+l)}h(e),console.log(w,i,a.current.children.item(0).clientHeight),b((e=>e.length===t.length&&e.every(((e,r)=>e===t[r]))?e:t))}}),[y,g]),n.fullScreen?e.createElement(o,{fullScreen:!0,ref:a},e.createElement(s.Provider,{value:{scroll:g,scrollHeight:i-window.innerHeight,height:window.innerHeight}},y)):e.createElement(c,{ref:u,className:n.className?n.className:""},e.createElement(o,{style:{height:i},ref:a},e.createElement(s.Provider,{value:{scroll:g,scrollHeight:i-u.current?u.current.clientHeight:0,height:u.current?u.current.clientHeight:0}},y)))},d={empty:()=>[{},{}],fadeOut(e,t,r){let l={position:"absolute",border:"1px solid yellow"},n=t;return console.log("y:",e,"yFullView:",t),e>100?l.opacity="0":e>n&&(l.opacity=""+(n-(e-n))/(100-n)),[{height:"context2",position:"sticky",top:0,border:"2px solid green"},l]},slideIn(e,t,r){void 0===r&&(r={});let l={position:"sticky",top:0,overflow:"hidden",width:"100%"},n={};return r.hold?n.height="context"+(r.hold+1):n.height="children3",l.transform=e<0?"translateX(-100%)":e>25?"translateX(0%)":r.right?`translateX(${100-(e-0)/25*100}%)`:`translateX(${(e-0)/25*100-100}%)`,l.right=r.right?"-50%":"50%",[n,l]},slideOut:(e,t,r)=>[{height:"slideOut"},{position:"slideOut"}],slideMe(e,t,r){void 0===r&&(r={});let l={position:"sticky",top:0,overflow:"hidden",width:"100%"},n={};return r.hold&&(n.height="context"+(r.hold+1)),l.transform=e<t?"translateX(-100%)":e>100?"translateX(0%)":r.right?`translateX(${100-(e-t)/(100-t)*200}%)`:`translateX(${(e-t)/(100-t)*200-100}%)`,l.right=r.right?"-50%":"50%",[n,l]}},a={numChildren:1,scrollSpeed:1},u=(e,t,r,l,n)=>{let i=(100-t-(n?0:t))/l;return[i,e<0?-1:e>r&&!n?l+1:Math.floor(e/i),e<0||e>r&&!n?0:(e-t)%i/i*100]},g={empty:()=>[{},{},[]],transition(e,t,r){let l=100-t>t?100-t:t;if(void 0===r||!r.numChildren)return[{},{},[]];Object.keys(a).forEach((e=>{r.hasOwnProperty(e)||(r[e]=a[e])}));let[n,i,o]=u(e,t,l,r.numChildren,r.toEnd),c=new Array(r.numChildren).fill({}).map(((e,t)=>{let l={top:0,position:"absolute",opacity:"0",transition:`opacity ${r.transitionSpeed?r.transitionSpeed:1}s`};return t===i&&(l.opacity="1"),l}));return[{height:r.scrollViewPort?`context${r.scrollSpeed}`:`children${r.scrollSpeed}`,border:"1px yellow solid",position:"relative"},{position:"sticky",overflow:"visible",top:0,border:"1px red solid"},c]},alternateSlideIn(e,t,r){let l=100-t>t?100-t:t;if(void 0===r||!r.numChildren)return[{},{},[]];Object.keys(a).forEach((e=>{r.hasOwnProperty(e)||(r[e]=a[e])}));let[n,i,o]=u(e,t,l,r.numChildren,r.toEnd),c=new Array(r.numChildren).fill({}).map(((e,t)=>{let l={top:0,right:"50%",transition:`transform ${r.transitionSpeed?r.transitionSpeed:1}s`};return t>=i&&(l.transform="translateX(-100%)"),l}));return r.scrollViewPort,r.scrollSpeed,[{height:"context5",border:"1px yellow solid",position:"relative"},{position:"sticky",overflow:"visible",top:0,border:"1px red solid"},c]}},p=n=>{const i=t(null),o=t(null),[c,h]=r(0),[a,u]=r(0),p=e.useContext(s),[m,f]=r({}),[y,v]=r({}),[w,b]=r([]),E=e=>{if(!e)return"100%";let[t,r]=e.split(/(context|children)(\d)$/).filter(Boolean),l=(e=>{let t=0;if(e.current)for(let r=0;r<e.current.children.length;r++)t+=e.current.children.item(r).clientHeight;return t})(i);return"context"===t?p.height?p.height*parseInt(r)+"px":"100%":i.current?l*parseInt(r)+"px":"100%"};return l((()=>{if(o.current&&o.current&&p.scroll>=o.current.offsetTop-p.height&&p.scroll<=o.current.offsetTop+o.current.clientHeight&&void 0!==n.startScroll){let e=p.scroll-(o.current.offsetTop-p.height);console.log(e,[(p.scroll-n.startScroll)/o.current.scrollHeight*100,p.height/o.current.scrollHeight*100],e/(o.current.clientHeight+p.height)*100,p.scroll,n.startScroll,o.current.scrollHeight),void 0!==n.startScroll?h((p.scroll-n.startScroll)/o.current.scrollHeight*100):h(0),u(p.height<=o.current.scrollHeight?p.height/o.current.scrollHeight*100:0)}}),[p.scroll,p.height]),l((()=>{let[e,t]=(e=>{let t=Object.keys(e).filter((e=>Object.keys(d).includes(e))),r=d.empty();return t.length>0&&(r=t.map((t=>d[t](c,a,e[t]))),r=r.reduce(((e,t)=>[Object.assign(e[0],t[0]),Object.assign(e[1],t[1])]))),r})(n);e.height=e.height?E(e.height):"100%";let[r,l,i]=(e=>{let t=Object.keys(e).filter((e=>Object.keys(g).includes(e))),r=g.empty(),l=e.children&&Array.isArray(e.children)?e.children.length:1;return t.length>0&&(r=t.map((t=>g[t](c,a,Object.assign({numChildren:l},e[t])))),r=r.reduce(((e,t)=>[Object.assign(e[0],t[0]),Object.assign(e[1],t[1])]))),r})(n);r.height&&(r.height=E(r.height)),f(Object.assign(e,r)),v(Object.assign(t,l)),b(i)}),[c,a]),e.createElement("div",{ref:o,style:m},e.createElement("div",{ref:i,style:y},e.Children.map(n.children,((t,r)=>{let l=r<w.length?w[r]:{};return e.createElement("div",{style:l},void 0!==t?e.cloneElement(t):void 0)}))))};export{p as ConfigurableSlide,i as HelloWorld,h as Presentation};
//# sourceMappingURL=index.js.map
