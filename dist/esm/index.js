import e,{useState as t,useRef as r,useEffect as n}from"react";import l from"styled-components";const i=l.div`
    contain: paint;
`,o=l.div`
    overflow-y: scroll;
    overflow-x: hidden;
`,c=e.createContext({current:"",scroll:0,scrollHeight:0,height:0,setScrollToSlide:e=>{}}),s=l=>{const[s,a]=t(0),h=r(new Array),d=r(),u=r(),[p,g]=t(-1),[m,f]=t(!1),[v,y]=t([]),[S,w]=t([]),[b,E]=t(""),O=(e,t)=>{e=e<0?0:e>=S.length?S.length-1:e;let r={left:0,top:S[e],behavior:"auto"};l.fullScreen?window.scrollTo(0,S[e]):u.current.scrollTo(r)},k=(e,t)=>{var r;if("number"==typeof e)e<0||e>=S.length?console.error("setScrollToSlide received slide out of bounds",0):O(e);else{let t=0;for(;t<l.children.length&&(!(null===(r=l.children[t].props)||void 0===r?void 0:r.title)||l.children[t].props.title!==e);t++);t===l.children.length?console.error("setScrollToSlide received unknown title"):O(t)}};return n((()=>{for(let e=0;e<S.length;e++)p>=S[e]&&(e===S.length-1||p<S[e+1])&&E(l.children[e].props.title?l.children[e].props.title:e);if(l.fullScreen){const e=e=>{g(window.scrollY),f(window.scrollY!==p)};return document.addEventListener("scroll",e),()=>document.removeEventListener("scroll",e)}if(d.current){const e=e=>{g(u.current.scrollTop),f(u.current.scrollY!==p)};return u.current.addEventListener("scroll",e),()=>u.current.addEventListener("scroll",e)}}),[p]),n((()=>{if(Array.isArray(l.children))y(l.children.map(((t,r)=>e.cloneElement(t,{startScroll:S[r],endScroll:S[r+1],ref:h.current[r]}))));else if(l.children){let t=[e.cloneElement(l.children,{startScroll:0,ref:h.current[0]})];y(t)}}),[l,S]),n((()=>{}),[h]),n((()=>{var e;let t=[0];if(null===(e=d.current)||void 0===e?void 0:e.children.length){let e=0;for(let r=0;r<d.current.children.length;r++){let n=d.current.children.item(r).scrollHeight;e+=n,r<d.current.children.length-1&&(t[r+1]=0===r?n:t[r]+n)}a(e),w((e=>e.length===t.length&&e.every(((e,r)=>e===t[r]))?e:t))}}),[v,p]),n((()=>{let t=require("../../package.json");console.log("DEVELOPMENT: ","react-scroll-presentation",t.version),console.log(d.current.children),console.log(l.children,e.isValidElement(l.children[0]),l.children[0].props)}),[]),l.fullScreen?e.createElement(i,{fullScreen:!0,ref:d},e.createElement(c.Provider,{value:{scroll:p,setScrollToSlide:e=>k(e),current:b,scrollHeight:s-window.innerHeight,height:window.innerHeight}},v)):e.createElement(o,{ref:u,className:l.className?l.className:""},e.createElement(i,{style:{height:s},ref:d},e.createElement(c.Provider,{value:{scroll:p,setScrollToSlide:e=>k(e),current:b,scrollHeight:s-u.current?u.current.clientHeight:0,height:u.current?u.current.clientHeight:0}},v)))},a=l=>{const i=r(null),o=e.useContext(c),[s,a]=t(0);return window.addEventListener("scroll",(e=>{})),n((()=>{i&&i.current&&a(i.current.scrollTop)}),[]),e.createElement("div",{style:{height:l.small?"100px":"100vh",display:"flex",flexDirection:"column",justifyContent:"center"}},e.createElement("p",null,l.title?l.title:o.current?o.current:"unknown title"),e.createElement("p",{ref:i,style:{textAlign:"center",fontSize:l.small?"1em":"5vw",margin:"auto"}},l.children?l.children:"Hello World, react-scroll-presentation"))},h={hold:1,slideBy:20,direction:"bottom"},d=e=>("object"!=typeof e?e=h:Object.keys(h).forEach((t=>{e.hasOwnProperty(t)||(e[t]=h[t])})),[e]),u={empty:()=>[{},{}],fadeOut(e,t,r){let n={height:(r=d(r)).hold?`context${r.hold}`:"context1",position:"sticky",top:0},l={width:"100%",position:"absolute"},i=t/5;return"development"===process.env.NODE_ENV&&console.log("y:",e,"yFullView:",t),e>100?(l.zIndex="-9999",l.opacity="0"):e>i&&(l.opacity=""+(100-i-(e-i))/(100-i)),[n,l]},springIn(e,t,r){let n={position:"sticky",transition:`transform ${(r=d(r)).transitionSpeed?r.transitionSpeed:1}s ease,\n                opacity ${r.transitionSpeed?r.transitionSpeed:1}s ease`,top:0,overflow:"hidden",width:"100%"};return e<0-t+t/3?(n.transform="right"===r.direction?"translateX(15%)":"left"===r.direction?"translateX(-15%)":"translateY(15%)",n.opacity="0.1"):n.opacity="1",[{},n]},slideIn(e,t,r){void 0===r&&(r={});let n={position:"sticky",top:0,overflow:"hidden",width:"100%"},l={};return r.hold?l.height="context"+(r.hold+1):l.height="children3",n.transform=e<0?"translateX(-100%)":e>25?"translateX(0%)":r.right?`translateX(${100-(e-0)/25*100}%)`:`translateX(${(e-0)/25*100-100}%)`,n.right=r.right?"-50%":"50%",[l,n]},slideOut:(e,t,r)=>[{height:"slideOut"},{position:"slideOut"}],slideMe(e,t,r){void 0===r&&(r={});let n={position:"sticky",top:0,overflow:"hidden",width:"100%"},l={};return r.hold&&(l.height="context"+(r.hold+1)),n.transform=e<t?"translateX(-100%)":e>100?"translateX(0%)":r.right?`translateX(${100-(e-t)/(100-t)*200}%)`:`translateX(${(e-t)/(100-t)*200-100}%)`,n.right=r.right?"-50%":"50%",[l,n]},header(e,t,r){r=d(r);return[{zIndex:11,height:"1px",position:"sticky",top:0},{zIndex:11,width:"100%",position:"absolute"}]}},p={numChildren:1,scrollViewPort:!1,scrollSpeed:1},g=(e,t,r,n,l)=>{let i=(100-t-(l?0:t))/n;return[i,e<0?-1:e>r&&!l?n+1:Math.floor(e/i),e<0||e>r&&!l?0:(e-t)%i/i*100]},m=e=>e.scrollViewPort?`context${e.scrollSpeed}`:`children${e.scrollSpeed}`,f=(e,t,r)=>{let n=100-t>t?100-t:t;return void 0!==r&&r.numChildren||(console.error("ERROR: ","Children Style Method didn't receive numChildren."),r=p),Object.keys(p).forEach((e=>{r.hasOwnProperty(e)||(r[e]=p[e])})),[n,r]},v=(e,t,r)=>{let n={};return r.background&&(n.backgroundImage=`url(${r.background})`,n.backgroundPosition="center",n.backgroundSize="contain",n.backgroundRepeat="no-repeat"),r.fullScreen&&(n.height="100vh",n.width="100%",e>0&&(n.opacity="0.8")),n},y={empty:()=>[{},{},[]],transition(e,t,r){let[n,l]=f(0,t,r),[i,o,c]=g(e,t,n,l.numChildren,l.toEnd),s=new Array(l.numChildren).fill({}).map(((e,t)=>{let r={top:0,position:"absolute",opacity:"0",transition:`opacity ${l.transitionSpeed?l.transitionSpeed:1}s`};return t===o&&(r.opacity="1"),r})),a=v(e,0,l);return[{height:m(l),position:"relative"},Object.assign(Object.assign({},a),{position:"sticky",overflow:"visible",top:0}),s]},alternateSlideIn(e,t,r){let[n,l]=f(0,t,r),[i,o,c]=g(e,t,n,l.numChildren,l.toEnd),s=new Array(l.numChildren).fill({}).map(((r,n)=>{let i={top:0,transition:e<0-t?"":`transform ${l.transitionSpeed?l.transitionSpeed:1}s`};return n>o&&(i.transform="translateX(-100%)"),l.staticFirstChild&&0===n&&(delete i.transform,delete i.transition),i})),a=v(e,0,l);return[{height:m(l),position:"relative"},Object.assign(Object.assign({},a),{WebkitPosition:"sticky",position:"sticky",overflow:"visible",top:0}),s]},revealSlideIn(e,t,r){let[n,l]=f(0,t,r);return[{height:"context1",position:"relative"},{position:"sticky",overflow:"visible",top:0},new Array(l.numChildren).fill({}).map(((t,r)=>{let n={transform:"translateX(-100%)"};return e>=0&&(n.transition=`transform ${1+r/10}s`,n.transform="translateX(-100%)"),n}))]}},S=l=>{const i=r(null),o=r(null),[s,a]=t(0),[h,d]=t(0),p=e.useContext(c),[g,m]=t({}),[f,v]=t({}),[S,w]=t([]),b=e=>{if(!e)return"100%";let[t,r]=e.split(/(context|children)(\d)$/).filter(Boolean);if(["context","children"].includes(t)){let e=(e=>{let t=0;if(e.current)for(let r=0;r<e.current.children.length;r++)t+=e.current.children.item(r).clientHeight;return t})(i);return"context"===t?p.height?p.height*parseInt(r)+"px":"100%":i.current?e*parseInt(r)+"px":"100%"}return e};return n((()=>{if(o.current&&void 0!==l.startScroll){let e=p.scroll-(o.current.offsetTop-p.height);"development"===process.env.NODE_ENV&&console.log(e,[(p.scroll-l.startScroll)/o.current.scrollHeight*100,p.height/o.current.scrollHeight*100],e/(o.current.clientHeight+p.height)*100,p.scroll,l.startScroll,o.current.scrollHeight),void 0!==l.startScroll?a((p.scroll-l.startScroll)/o.current.scrollHeight*100):a(0),d(p.height<=o.current.scrollHeight?p.height/o.current.scrollHeight*100:0)}}),[p.scroll,p.height]),n((()=>{let[e,t]=(e=>{let t=Object.keys(e).filter((e=>Object.keys(u).includes(e))),r=u.empty();return t.length>0&&(r=t.map((t=>u[t](s,h,e[t]))),r=r.reduce(((e,t)=>[Object.assign(e[0],t[0]),Object.assign(e[1],t[1])]))),r})(l);e.height=e.height?b(e.height):"100%";let[r,n,i]=(e=>{let t=Object.keys(e).filter((e=>Object.keys(y).includes(e))),r=y.empty(),n=e.children&&Array.isArray(e.children)?e.children.length:1;return t.length>0&&(r=t.map((t=>y[t](s,h,Object.assign({numChildren:n},e[t])))),r=r.reduce(((e,t)=>[Object.assign(e[0],t[0]),Object.assign(e[1],t[1])]))),r})(l);r.height&&(r.height=b(r.height)),m(Object.assign(e,r)),v(Object.assign(t,n)),w(i)}),[s,h]),e.createElement("div",{ref:o,style:g},e.createElement("div",{ref:i,style:f},l.header&&e.createElement("div",{style:{position:"sticky",top:0,border:0,padding:0,margin:0}},l.header),e.Children.map(l.children,((t,r)=>{let n=r<S.length?S[r]:{};return e.createElement("div",{style:n},void 0!==t?e.cloneElement(t):void 0)}))))};export{S as ConfigurableSlide,a as HelloWorld,s as Presentation,c as PresentationContext};
//# sourceMappingURL=index.js.map
